{% extends 'transfers/website_base.html' %}
{% load static %}
{% block content %}

    <script
    src="https://code.jquery.com/jquery-3.4.1.js"
    integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
    crossorigin="anonymous"></script>

    <!-- Bootstrap CDN -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    <!-- Vue CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>

    <!-- AXIOS CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.js"></script>
    <!-- Custom CSS/ Js -->
    <!-- <script src="js/custom.js"></script> -->
    <link rel="stylesheet" href="{% static 'transfers/css/custom.css' %}"/>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.js"></script>

<div class="container-fluid site-section" id="mainContent">    
    <div class="row px-0 d-flex justify-content-center shadow col-md-12 text-center" id="intro">      
      <div class="col-md-4 m-0 pt-2 container-fluid"> 

      <h1 class="text-dark"> Transfer Management System </h1>
      </div>
      <div class="col-md-6">
       
        <div class="btn-group btn p-0 " id="typeOfPage">
         
             <br>   
            <div class="btn-group-toggle btn" id="type" data-toggle="buttons">
                <p class="text-dark h5"> Please Select the Category of Forms : </p>
              
                <button type="radio" class="btn btn-primary btn-lg m-3" @click="showTS2PS=false, init=true, type_val=0; getTS2PSdata();" name="type" id="1" value="0" autocomplete="off">PS To TS Requests
                </button>
                  
              
                <button class="btn btn-secondary btn-lg m-3" @click="showTS2PS=true, init=true, type_val=1; getTS2PSdata();" type="radio" name="type" id="1" value="1" autocomplete="off">TS To PS Requests</button>
             
            </div>
        </div>    
      </div>
    </div>

    <div class="container mt-3 table-striped text-center table-responsive shadow" style="min-height: 600px;">
      <div v-if="!init" class="site-section">
        <span class="text-center bg-light mt-5 py-4 h3"><i>Please Select the Category of Froms From Above.</i></span>
      </div>



      <table v-if="showTS2PS == false & init" class="table text-center table-striped table-hover ">
        <br v-if="showTS2PS == false & init">
        <h2 v-if="showTS2PS == false & init" id="heading" class="text-center text-dark">Status of PS to TS Transfer Requests</h2>
        <div v-if="showTS2PS == false & init" class="btn-group dropdown">          
          <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Select Branch
          </button>
          <div class="dropdown-menu" aria-labelledby="dropupMenuLink">
            <a class="dropdown-item" href="#" id="AA" @click="getBranch('AA')">AA</a>
            <a class="dropdown-item" href="#" id="A1" @click="getBranch('A1')">A1</a>
            <a class="dropdown-item" href="#" id="A3" @click="getBranch('A3')">A3</a>
            <a class="dropdown-item" href="#" id="A4" @click="getBranch('A4')">A4</a>
            <a class="dropdown-item" href="#" id="A7" @click="getBranch('A7')">A7</a>
            <a class="dropdown-item" href="#" id="A8" @click="getBranch('A8')">A8</a>
            <a class="dropdown-item" href="#" id="B1" @click="getBranch('B1')">B1</a>
            <a class="dropdown-item" href="#" id="B2" @click="getBranch('B2')">B2</a>
            <a class="dropdown-item" href="#" id="B3" @click="getBranch('B3')">B3</a>
            <a class="dropdown-item" href="#" id="B4" @click="getBranch('B4')">B4</a>
            <a class="dropdown-item" href="#" id="B5" @click="getBranch('B5')">B5</a>
            <a class="dropdown-item" href="#" id="All (Default)" @click="getBranch('')">All (Default)</a>
          </div>
          <span id="branch" class="m-2 ml-4">All (Default)</span>
        </div>
        
        <br v-if="showTS2PS == false & init">
        <section v-if="showTS2PS == false & init" class="row col-md-5 pt-2  offset-md-4 container-fluid d-flex justify-content-center ">    
          <i>Press to toggle requests</i>
            <label class="switch m-auto">            
                  <input class="switch-input"  v-model="showApproved" type="checkbox" />
                  <span class="switch-label"  data-on="Not Approved" data-off="Approved"></span> 
                  <span class="switch-handle"></span> 
            </label>
        </section>

        <!-- Approved -->
        <br v-if="showTS2PS == false & init & !showApproved">
        <thead v-if="showTS2PS==false & init & !showApproved" id="table-head">
          <tr style="font-size: 20px"> <th>College ID</th><th>Name</th><th>Supervisor</th><th>HoD</th><th>Date of Application</th></tr>                     
        </thead>
        <tbody v-if="!data_approved.length && showTS2PS == false & !showApproved" class="text-center text-dark" id="table-body"> 
          <td colspan="5" style="font-size: 22px">No Applications in This Category</td>
        </tbody>
        <tbody v-if="showTS2PS == false & !showApproved" class="text-center" id="table-body">
          <tr  v-for="data in data_approved" data-toggle="modal" data-id="0" data-target="#applicationModal" @click="modal_student=data">
            <td id="name">${data.applicant__user__username}</td>
            <td id="name">${data.applicant__user__first_name} ${data.applicant__user__last_name}</td> 
            <td>${getStatusToWords(data.is_supervisor_approved)}</td>          
            <td>${getStatusToWords(data.is_hod_approved)}</td>
            <td>${getDate(data.application_date)}</td>
          </tr>
        </tbody>      

      <!-- Not Approved -->
        <br v-if="showTS2PS == false & init & showApproved">
        <thead v-if="showTS2PS==false & init & showApproved" id="table-head">
          <tr style="font-size: 20px"> <th>College ID</th><th>Name</th><th>Supervisor</th><th>HoD</th><th>Date of Application</th></tr>        
        </thead>
        <tbody v-if="!data_not_approved.length && showTS2PS==false & init & showApproved" class="text-center text-dark" id="table-body"> 
          <td colspan="5" style="font-size: 22px">No Applications in This Category</td>
        </tbody>
        <tbody v-if="showTS2PS == false & showApproved" class="text-center" id="table-body">
          <tr  v-for="data in data_not_approved" data-toggle="modal" data-id="0" data-target="#applicationModal" @click="modal_student=data">
            <td id="name">${data.applicant__user__username}</td>
            <td id="name">${data.applicant__user__first_name} ${data.applicant__user__last_name}</td> 
            <td>${getStatusToWords(data.is_supervisor_approved)}</td>          
            <td>${getStatusToWords(data.is_hod_approved)}</td>
            <td>${getDate(data.application_date)}</td>
          </tr>
        </tbody>
      </table>



      <table v-if="showTS2PS == true & init" class="table text-center table-striped table-hover ">
        <br v-if="showTS2PS == true & init">        
        <h2 v-if="showTS2PS == true & init" id="heading" class="text-center text-dark">Status of TS to PS Transfer Requests</h2>
        <div v-if="showTS2PS == true & init" class="btn-group dropdown">          
          <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Select Branch
          </button>
          <div class="dropdown-menu" aria-labelledby="dropupMenuLink">
            <a class="dropdown-item" href="#" id="AA" @click="getBranch('AA')">AA</a>
            <a class="dropdown-item" href="#" id="A1" @click="getBranch('A1')">A1</a>
            <a class="dropdown-item" href="#" id="A3" @click="getBranch('A3')">A3</a>
            <a class="dropdown-item" href="#" id="A4" @click="getBranch('A4')">A4</a>
            <a class="dropdown-item" href="#" id="A7" @click="getBranch('A7')">A7</a>
            <a class="dropdown-item" href="#" id="A8" @click="getBranch('A8')">A8</a>
            <a class="dropdown-item" href="#" id="B1" @click="getBranch('B1')">B1</a>
            <a class="dropdown-item" href="#" id="B2" @click="getBranch('B2')">B2</a>
            <a class="dropdown-item" href="#" id="B3" @click="getBranch('B3')">B3</a>
            <a class="dropdown-item" href="#" id="B4" @click="getBranch('B4')">B4</a>
            <a class="dropdown-item" href="#" id="B5" @click="getBranch('B5')">B5</a>
            <a class="dropdown-item" href="#" id="All (Default)" @click="getBranch('')">All (Default)</a>
          </div>
          <span id="branch" class="m-2 ml-4">All (Default)</span>
        </div>
        <br v-if="showTS2PS == true & init">
        <section v-if="showTS2PS == true & init" class="row col-md-5 pt-2  offset-md-4 container-fluid d-flex justify-content-center ">    
          <i>Press to toggle requests</i>
          <label class="switch m-auto">            
                <input class="switch-input"  v-model="showApproved" type="checkbox" />
                <span class="switch-label"  data-on="Not Approved" data-off="Approved"></span> 
                <span class="switch-handle"></span> 
          </label>
        </section>

        <!-- Approved -->
        <br v-if="showTS2PS == true & init & !showApproved">
        <thead v-if="showTS2PS==true & init & !showApproved" id="table-head">
          <tr style="font-size: 20px"><th>College ID</th><th>Name</th><th>HoD</th><th>Date of Application</th></tr>                   
        </thead>        
        <tbody v-if="!data_approved.length && showTS2PS==true & init & !showApproved" class="text-center text-dark" id="table-body"> 
          <td colspan="4" style="font-size: 22px">No Applications in This Category</td>
        </tbody>
        <tbody v-if="showTS2PS==true & init & !showApproved" class="text-center" id="table-body">
        <tr v-for="data in data_approved" data-toggle="modal" data-id="1" data-target="#applicationModal" @click="modal_student=data">
          <td id="name">${data.applicant__user__username}</td>
          <td id="name">${data.applicant__user__first_name} ${data.applicant__user__last_name}</td>           
          <td>${getStatusToWords(data.is_hod_approved)}</td>
          <td>${getDate(data.application_date)}</td>
        </tr>
        </tbody>      

      <!-- Not Approved -->
        <br v-if="showTS2PS == true & init & showApproved">
        <thead v-if="showTS2PS==true & init & showApproved" id="table-head">
            <tr style="font-size: 20px"><th>College ID</th><th>Name</th><th>HoD</th><th>Date of Application</th></tr>                   
        </thead>  
        <tbody v-if="!data_not_approved.length && showTS2PS==true & init & showApproved" class="text-center text-dark" id="table-body"> 
          <td colspan="4" style="font-size: 22px">No Applications in This Category</td>
        </tbody>      
        <tbody v-if="showTS2PS==true & init & showApproved" class="text-center" id="table-body">
          <tr v-for="data in data_not_approved" data-toggle="modal" data-id="1" data-target="#applicationModal" @click="modal_student=data">
            <td id="name">${data.applicant__user__username}</td>
            <td id="name">${data.applicant__user__first_name} ${data.applicant__user__last_name}</td>           
            <td>${getStatusToWords(data.is_hod_approved)}</td>
            <td>${getDate(data.application_date)}</td>
          </tr>
        </tbody>
      </table>

      <div class="modal fade" v-for="student in data_all" id="applicationModal" tabindex="-1" role="dialog" >
        <div class="modal-dialog  modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">                                     
              <h3 class="text-dark modal-title">Transfer Request</h3>          
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div> 
            <div class="modal-body">
             <table>
              <tr v-if="showTS2PS==false" v-for="attr in modal_student_ps2ts_attr">
                  <td class="text-left text-dark"><strong>${attr.display}</strong></td>
                  <td v-if="attr.display=='HOD Approval Status' || attr.display=='Supervisor Approval Status'">${getStatusToWords(modal_student[attr.props])}</td>
                  <td v-if="attr.display=='Location of Thesis'">${getThesisLocaleToWords(modal_student[attr.props])}</td>
                  <td v-if="attr.display=='Date of Application'">${modal_student[attr.props]}</td>
                  <td v-if="attr.display!='HOD Approval Status' && attr.display!='Supervisor Approval Status' && attr.display!='Location of Thesis' && attr.display!='Date of Application'" class="text-dark">${modal_student[attr.props]}${modal_student[attr.props2]}</td>
                </tr>
             </table>
             <table>
              <tr v-if="showTS2PS==true" v-for="attr in modal_student_ts2ps_attr">
                  <td class="text-left text-dark"><strong>${attr.display} </strong></td>
                  <td v-if="attr.display=='HOD Approval Status'">${getStatusToWords(modal_student[attr.props])}</td>                  
                  <td v-if="attr.display!='HOD Approval Status'" class="text-dark">${modal_student[attr.props]} ${modal_student[attr.props2]}</td>
                </tr>
                <tr v-if="!showApproved" >                  
                  <form>
                  <td colspan="2"><textarea class="form-control" v-model="comments" rows="3" cols="4" placeholder="Enter Comments Here"></textarea></td>
                  </form>                  
                </tr>
             </table>
            </div>     
            <div v-if="!showApproved" class="text-center d-flex justify-content-around align-items-center">
                  <button @click="rejectRequest(modal_student)" class="btn btn-md  btn-danger text-light text-center mb-2">Reject Request</button>  
            </div>         
            <div class="modal-footer">
                <button id="closeModal" class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            </div>
          </div>
           
        </div>
      </div>

      </div>
        
</div>

    
<br>
<br>


<script>  
  $('#dropdownMenuButton + [aria-labelledby="dropdownMenuButton"] a').on('click', function (e) {
  e.preventDefault();   
  console.log(this.text());
});

 var vm= new Vue({
       delimiters : ['${', '}'],
       el:"#mainContent",
       data:
       {
        type_val:1,
        data_all:[],
        modal_student:{},        
        modal_student_ps2ts_attr:[{'props':'applicant__user__username','display':'Student ID'},
                            {'props':'applicant__user__first_name','display':'Student Name'},
                            {'props2':'applicant__user__last_name'},
                            {'props':'is_hod_approved','display':'HOD Approval Status'},
                            {'props':'is_supervisor_approved','display':'Supervisor Approval Status'},
                            {'props':'sub_type','display':'Subject Type'},
                            {'props':'cgpa','display':'CGPA'},
                            {'props':'thesis_locale','display':'Location of Thesis'},
                            {'props':'supervisor_email','display':'Supervisor Email'},
                            {'props':'thesis_subject','display':'Subject of Thesis'},
                            {'props':'name_of_org','display':'Organization Name'},
                            {'props':'expected_deliverables','display':'Expected Deliverables'},
                            {'props':'application_date','display':'Date of Application'},
                            ],
        modal_student_ts2ps_attr:[{'props':'applicant__user__username','display':'Student ID'},
                            {'props':'applicant__user__first_name','display':'Student Name'},
                            {'props2':'applicant__user__last_name'},      
                            {'props':'is_hod_approved','display':'HOD Approval Status'},          
                            {'props':'sub_type','display':'Subject Type'},
                            {'props':'cgpa','display':'CGPA'},
                            {'props':'name_of_org','display':'Organization Name'},
                            {'props':'application_date','display':'Date of Application'},
                            ],
        showTS2PS:true,
        init:false,
        showApproved:false,
        comments:"",        
        status:2,
        data_not_approved:[],        
        data_approved:[], 
        data_not_approved_old:[],        
        data_approved_old:[], 
        data_AA_approved:[],
        data_AA_not_approved:[],
        data_A1_approved:[],
        data_A1_not_approved:[], 
        data_A3_approved:[],
        data_A3_not_approved:[],
        data_A4_approved:[],
        data_A4_not_approved:[],
        data_A7_approved:[],
        data_A7_not_approved:[],
        data_A8_approved:[],
        data_A8_not_approved:[],      
        data_B1_approved:[],
        data_B1_not_approved:[],
        data_B2_approved:[],
        data_B2_not_approved:[],
        data_B3_approved:[],
        data_B3_not_approved:[],
        data_B4_approved:[],
        data_B4_not_approved:[],
        data_B5_approved:[],
        data_B5_not_approved:[],
       },

       methods:
       {    
        getBranch(str)
        {
          if(str=="")
          {
            this.data_approved=this.data_approved_old;
            this.data_not_approved=this.data_not_approved_old;
            document.getElementById("branch").textContent="All (Default)";
          }
          if(str=="AA")
          {
            this.data_approved=this.data_AA_approved;
            this.data_not_approved=this.data_AA_not_approved;
            document.getElementById("branch").textContent="AA";
          } 
          if(str=="A1")
          {
            this.data_approved=this.data_A1_approved;
            this.data_not_approved=this.data_A1_not_approved;
            document.getElementById("branch").textContent="A1";
          } 
          if(str=="A3")
          {
            this.data_approved=this.data_A3_approved;
            this.data_not_approved=this.data_A3_not_approved;
            document.getElementById("branch").textContent="A3";
          } 
          if(str=="A4")
          {
            this.data_approved=this.data_A4_approved;
            this.data_not_approved=this.data_A4_not_approved;
            document.getElementById("branch").textContent="A4";
          }        
          if(str=="A7")
          {
            this.data_approved=this.data_A7_approved;
            this.data_not_approved=this.data_A7_not_approved;
            document.getElementById("branch").textContent="A7";
          } 
          if(str=="A8")
          {
            this.data_approved=this.data_A8_approved;
            this.data_not_approved=this.data_A8_not_approved;
            document.getElementById("branch").textContent="A8";
          } 
          if(str=="B1")
          {
            this.data_approved=this.data_B1_approved;
            this.data_not_approved=this.data_B1_not_approved;
            document.getElementById("branch").textContent="B1";
          } 
          if(str=="B2")
          {
            this.data_approved=this.data_B2_approved;
            this.data_not_approved=this.data_B2_not_approved;
            document.getElementById("branch").textContent="B2";
          } 
          if(str=="B3")
          {
            this.data_approved=this.data_B3_approved;
            this.data_not_approved=this.data_B3_not_approved;
            document.getElementById("branch").textContent="B3";
          } 
          if(str=="B4")
          {
            this.data_approved=this.data_B4_approved;
            this.data_not_approved=this.data_B4_not_approved;
            document.getElementById("branch").textContent="B4";
          } 
          if(str=="B5")
          {
            this.data_approved=this.data_B5_approved;
            this.data_not_approved=this.data_B5_not_approved;
            document.getElementById("branch").textContent="B5";
          } 

        },
        getDate(datee)
        {
          //console.log(datee.substr(0,10)+"  "+datee.substr(11,8));
          var date=datee.substr(0,10)+"  "+datee.substr(11,8);
          return (date)
        },
        getStatusToWords(status_value)
          {   //console.log(status_value);
              if(status_value == 0)
              {
                  return "Pending";
              }
              else if(status_value == 1)
              {
                  return "Approved";   
              }
              else if(status_value == 2)
              {   
                  return "Rejected";  
              }
              /*else if(status_value == 3)
              {
                return "Approved";
              }*/
          },      
          getThesisLocaleToWords(status_value)
          {
              if(status_value == 0)
              {
                  return "On Campus";
              }
              else if(status_value == 1)
              {
                  return "Off Campus India";   
              }
              else if(status_value == 2)
              {              
                  return "Off Campus Abroad";  
              }
              else if(status_value == 3)
              {
                return "Off Campus Industry";
              }
          },       
        getTS2PSdata()
        {             
          this.data_not_approved=[];        
          this.data_approved=[]; 
          this.data_not_approved_old=[];        
          this.data_approved_old=[]; 
          this.data_AA_approved=[];
          this.data_AA_not_approved=[];
          this.data_A1_approved=[];
          this.data_A1_not_approved=[]; 
          this.data_A3_approved=[];
          this.data_A3_not_approved=[];
          this.data_A4_approved=[];
          this.data_A4_not_approved=[];
          this.data_A7_approved=[];
          this.data_A7_not_approved=[];
          this.data_A8_approved=[];
          this.data_A8_not_approved=[];      
          this.data_B1_approved=[];
          this.data_B1_not_approved=[];
          this.data_B2_approved=[];
          this.data_B2_not_approved=[];
          this.data_B3_approved=[];
          this.data_B3_not_approved=[];
          this.data_B4_approved=[];
          this.data_B4_not_approved=[];
          this.data_B5_approved=[];
          this.data_B5_not_approved=[];
          axios.get('/TMS/data/assoc-dean/get-transfer-lists/type/'+this.type_val+'/')
          .then(response=>
          {
            this.data_all=response.data;
            console.log(response.data[0].is_hod_approved)
            this.data_approved=this.data_all;
            this.data_approved_old=this.data_all;
            //this.data_approved=response.data.data_approved;
            //this.data_approved_old=response.data.data_approved;
            //this.data_not_approved=response.data.data_not_approved;
            //this.data_not_approved_old=response.data.data_not_approved;
            //console.log(response.data[11]);
            for (index=0;index<this.data_approved.length; index++) 
            {
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="AA") 
              {
                //console.log("here")
                this.data_AA_approved.push(response.data[index]);
                //console.log(this.data_A3[0].applicant__user__username)
              }
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="A1") 
              {                
                this.data_A1_approved.push(response.data[index]); 
                console.log(this.data_A1_approved[0].applicant__user__username) 
                console.log(this.data_A1_approved) 
                console.log(this.data_approved)           
              }
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="A3") 
              {                
                this.data_A3_approved.push(response.data[index]);               
              }
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="A4") 
              {                
                this.data_A4_approved.push(response.data[index]);               
              }
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="A7") 
              {                
                this.data_A7_approved.push(response.data[index]);               
              }
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="A8") 
              {                
                this.data_A8_approved.push(response.data[index]);               
              }
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="B1") 
              {                
                this.data_B1_approved.push(response.data[index]);               
              }
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="B2") 
              {                
                this.data_B2_approved.push(response.data[index]);               
              }
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="B3") 
              {                
                this.data_B3_approved.push(response.data[index]);               
              }
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="B4") 
              {                
                this.data_B4_approved.push(response.data[index]);               
              }
              if (this.data_approved[index].applicant__user__username.substring(4,6)=="B5") 
              {                
                this.data_B5_approved.push(response.data[index]);               
              }
            }

            for (index=0;index<this.data_not_approved.length; index++) 
            {
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="AA") 
              {
                //console.log("here")
                this.data_AA_not_approved.push(response.data[index]);
                //console.log(this.data_A3[0].applicant__user__username)
              }
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="A1") 
              {                
                this.data_A1_not_approved.push(response.data[index]);               
              }
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="A3") 
              {                
                this.data_A3_not_approved.push(response.data[index]);               
              }
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="A4") 
              {                
                this.data_A4_not_approved.push(response.data[index]);               
              }
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="A7") 
              {                
                this.data_A7_not_approved.push(response.data[index]);               
              }
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="A8") 
              {                
                this.data_A8_not_approved.push(response.data[index]);               
              }
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="B1") 
              {                
                this.data_B1_not_approved.push(response.data[index]);               
              }
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="B2") 
              {                
                this.data_B2_not_approved.push(response.data[index]);               
              }
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="B3") 
              {                
                this.data_B3_not_approved.push(response.data[index]);               
              }
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="B4") 
              {                
                this.data_B4_not_approved.push(response.data[index]);               
              }
              if (this.data_not_approved[index].applicant__user__username.substring(4,6)=="B5") 
              {                
                this.data_B5_not_approved.push(response.data[index]);               
              }
            }
          })
        if(this.init)
           { 
            document.getElementById("branch").textContent="All (Default)";  } 
        },
        rejectRequest(stud)
         {
           //console.log(stud.applicant__user__username);
           if(confirm('Are you sure to reject '+stud.applicant__user__first_name+'\'s request'))
           axios.get('/TMS/data/reject-transfer-request?student_username='+stud.applicant__user__username+'&status='+this.status+'&comments='+this.comments+'&application_type='+this.type_val)
           .then(response=>
           {
              response = response.data;
              if(response.error)
              {
                document.getElementById('closeModal').click();
              alert('Error Rejecting this request, Contact Adminstrator', response.message);}
              else{
                document.getElementById('closeModal').click();
                alert('Request rejected! ',response.message);}
           })
           .catch(error =>
           {
             alert('Error reaching server, Contact adminstrator.'+error)
           })
           .finally(x=>
           {  
              document.getElementById("branch").textContent="All (Default)";
             this.getTS2PSdata();
           })
         }       
      },
       mounted()
       {            
          this.getTS2PSdata();                             
       },


     })
  </script>



<style type="text/css">
  
table
{
  table-layout: fixed;
  /*font-size:80%;*/
  width: 100%;

}
.elementRow td
{
  max-width: 30%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;

}
#name{
  max-width: 30%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  /*word-wrap: break-word;*/
}

.switch {
  position: relative;
  display: block;
  width: 200px;
  height: 30px;
  padding: 5px;
  margin: 0 10px 10px 0;
  background: linear-gradient(to bottom, #eeeeee, #FFFFFF 25px);
  background-image: -webkit-linear-gradient(top, #eeeeee, #FFFFFF 25px);
  border-radius: 18px;
  box-shadow: inset 0 -1px white, inset 0 1px 1px rgba(0, 0, 0, 0.05);
  cursor: pointer;
  box-sizing:content-box;
}
.switch-input {
  position: absolute;
  top: 0;
  left: 0;
  opacity: 0;
  box-sizing:content-box;
}
.switch-label {
  position: relative;
  display: block;
  height: inherit;
    font-size: 15px;
    font-family: Georgia, 'Times New Roman', Times, serif;
  text-transform: uppercase;
  background: rgb(0, 194, 0);
  border-radius: inherit;
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.12), inset 0 0 2px rgba(0, 0, 0, 0.15);
  box-sizing:content-box;
}
.switch-label:before, .switch-label:after {
  position: absolute;
  top: 50%;
  margin-top: -.5em;
  line-height: 1;
  -webkit-transition: inherit;
  -moz-transition: inherit;
  -o-transition: inherit;
  transition: inherit;
  box-sizing:content-box;
}
.switch-label:before {
  content: attr(data-off);
  right: 15px;
  color:whitesmoke;
  
}
.switch-label:after {
  content: attr(data-on);
  left: 11px;
  color: rgb(255, 255, 255);
  text-shadow: 0 1px rgba(0, 0, 0, 0.2);
  opacity: 0;
}
.switch-input:checked ~ .switch-label {
  background: #ff3333;
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.15), inset 0 0 3px rgba(0, 0, 0, 0.2);
}
.switch-input:checked ~ .switch-label:before {
  opacity: 0;
}
.switch-input:checked ~ .switch-label:after {
  opacity: 1;
}
.switch-handle {
  position: absolute;
  top: 3px;
  left: 3px;
  width: 32px;
  height: 32px;
  background: linear-gradient(to bottom, #FFFFFF 40%, #f0f0f0);
  background-image: -webkit-linear-gradient(top, #FFFFFF 40%, #f0f0f0);
  border-radius: 100%;
  box-shadow: 1px 1px 5px rgba(0, 0, 0, 0.2);
}
.switch-handle:before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -6px 0 0 -6px;
  width: 12px;
  height: 12px;
  background: linear-gradient(to bottom, #eeeeee, #FFFFFF);
  background-image: -webkit-linear-gradient(top, #eeeeee, #FFFFFF);
  border-radius: 6px;
  box-shadow: inset 0 1px rgba(0, 0, 0, 0.02);
}
.switch-input:checked ~ .switch-handle {
  left: 175px;
  box-shadow: -1px 1px 5px rgba(0, 0, 0, 0.2);
}
 
/* Transition
========================== */
.switch-label, .switch-handle {
  transition: All 0.3s ease;
  -webkit-transition: All 0.3s ease;
  -moz-transition: All 0.3s ease;
  -o-transition: All 0.3s ease;
}
</style>



{% endblock %}


<!-- 
<script type="text/javascript">    
    

    function getData(type)
    {
      var type_val=type;
      //console.log(type_val);  
      
      $.ajax({
        url: '/TMS/data/assoc-dean/get-transfer-lists/type/'+type_val+'/',
        type:'GET',
        success: function(response)
        {
          $('#table-body').html('');
          $('#table-head').html('');
          $('#heading').html('');
          var len=response.length;
          //console.log(len);
          if(type_val == 0)
          {  
            $('#heading').html('Status of PS to TS Transfer Requests');
            var head="<tr> <th>College ID</th><th>Name</th><th>Supervisor</th><th>HoD</th></tr>"
            $('#table-head').html(head);

          if(len==0)
          {
            var entry="<tr><td colspan=4> <h3>No Applications</h3></td></tr>";
            $('#table-body').append(entry);
          }

          for(var i=0;i<len;i++)
          {         
            var id = response[i].applicant__user__username;
            var name = response[i].applicant__user__first_name + response[i].applicant__user__last_name;
            var hod = response[i].is_hod_approved;
            var sup = response[i].is_supervisor_approved;
            var entry="<tr data-toggle=modal data-id=1 data-target=#applicationModal><td>"+id+"</td><td>"+name+"</td><td>"+sup+"</td><td>"+hod+"</td></tr>";
            $('#table-body').append(entry);
          }

          }
          else if(type_val==1)
          {
            $('#heading').html('Status of TS to PS Transfer Requests');
            var head="<tr> <th>College ID</th><th>Name</th><th>HoD</th></tr>"
            $('#table-head').html(head);

            if(len==0)
            {
              var entry="<tr><td colspan=3> <h3>No Applications</h3></td></tr>";
              $('#table-body').append(entry);
            }

            for(var i=0;i<len;i++)
            {         
              var id = response[i].applicant__user__username;
              var name = response[i].applicant__user__first_name + response[i].applicant__user__last_name;
              var hod = response[i].is_hod_approved;
              var entry="<tr data-toggle="+"modal"+" data-id="+id+" data-target="+"#applicationModal"+"><td>"+id+"</td><td>"+name+"</td><td>"+hod+"</td></tr>";              
              $('#table-body').append(entry);
            }
          }         

        }

      });             

    }

</script>


 -->